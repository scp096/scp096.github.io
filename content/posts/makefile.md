---
title: "Makefile一些用法"
date: 2023-01-11T11:58:55+08:00
---
## 注释
前面加 #

## 不输出指令
指令前面加 @\
![不输出指令](/不输出指令.png)

## 纯指令
- ### .PHONY:***
    指定为纯指令，而非文件

## 定义变量
- = 是最基本的赋值，后续的=会影响前面的值
- := 是覆盖之前的值，不会影响前面的值
- ?= 是如果没有被赋值过就赋予等号后面的值
- += 是添加等号后面的值

**make指令后面添加的变量赋值一定会覆盖掉脚本定义的值**\
![定义变量](/定义变量.png)\
![定义变量2](/定义变量2.png)

## 内置变量
- ### .DEFAULT_GOAL=***
    Makefile默认执行指令\
    默认为 all， 可以修改成别的
- ### $@
    指令本身
- ### $^
    所有依赖项
- ### $<
    第一个依赖项

![内置变量1](/内置变量1.png)\
![内置变量2](/内置变量2.png)

## 引用 Makefile 变量
"$()" 或者 "${}"

## 调用 shell
"$(shell shell指令)"\
**通常用于复杂 shell 语句定义 Makefile 变量**\
**在 shell 里定义的变量啊无法跨多个 shell 语句**\
![调用shell](/调用shell1.png)\
![调用shell](/调用shell2.png)

## 指令模糊匹配
在指令上加%\
![指令模糊匹配](/指令模糊匹配1.png)\
![指令模糊匹配](/指令模糊匹配2.png)

## 条件判断
可以通过判断变量决定是否定义指令，但不能作用于指令内容
![条件判断](/条件判断1.png)\
![条件判断](/条件判断2.png)

## 分组依赖
一个指令的依赖不一定需要所有定义在一起，也可以分开定义依赖\
用双冒号"::"来设置依赖\
![分组依赖](/分组依赖.png)

## 函数定义
可以定义函数，使用 call 来调用，第一个是函数，后面是参数，用逗号隔开\
![函数定义](/函数定义1.png)\
![函数定义](/函数定义2.png)

